<aside class="sidebar">
    <div class="sidebar-list">

        {% if page.collection == "projects" or page.url contains "/projects" %}
            {% assign items = site.projects %}
        {% elsif page.collection == "drawings" or page.url contains "/drawings" %}
            {% assign items = site.drawings %}
        {% elsif page.collection == "archive" or page.url contains "/archive" %}
            {% assign items = site.archive %}
        {% elsif page.collection == "about" or page.url contains "/about" %}
            {% assign items = site.about %}
        {% else %}
            {% assign items = nil %}
        {% endif %}

        {% if items %}

            {% assign parents = items 
                | where_exp: "item", "item.parent == nil" 
                | sort: "date" 
                | reverse %}

            {% for item in parents %}

                <div class="sidebar-group {% if page.parent == item.slug %}open{% endif %}">

                    <a href="{{ item.url }}"
                       class="{% if page.url contains item.url %}active{% endif %}">
                        {{ item.title }}
                    </a>

                    {% assign children = items 
                        | where: "parent", item.slug 
                        | sort: "date" 
                        | reverse %}

                    {% if children.size > 0 %}
                        <div class="sidebar-sub">
                            {% for child in children %}
                                <a href="{{ child.url }}"
                                   class="{% if page.url contains child.url %}active{% endif %}">
                                    {{ child.title }}
                                </a>
                            {% endfor %}
                        </div>
                    {% endif %}

                </div>

            {% endfor %}

        {% endif %}

    </div>
</aside>